(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2715:function(t,e,r){Promise.resolve().then(r.bind(r,588))},588:function(t,e,r){"use strict";r.d(e,{AuthProvider:function(){return l},a:function(){return h}});var n=r(266),s=r(1076),o=r(5699),i=r(2014);let a="aivo_auth_state",c=(0,s.createContext)(void 0),u=t=>(function(t){let e=i.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000";return new o.A(e,t)})(t),l=t=>{let{children:e}=t,[r,o]=(0,s.useState)({accessToken:null,user:null});(0,s.useEffect)(()=>{o(function(){try{let t=window.localStorage.getItem(a);if(!t)return{accessToken:null,user:null};return JSON.parse(t)}catch(t){return{accessToken:null,user:null}}}())},[]);let l=u((0,s.useCallback)(async()=>r.accessToken,[r.accessToken])),h=async(t,e)=>{let r=await fetch("".concat(i.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});if(!r.ok)throw Error(await r.text()||"Login failed");let n=await r.json(),s={accessToken:n.accessToken,user:n.user};o(s),window.localStorage.setItem(a,JSON.stringify(s))};return(0,n.jsx)(c.Provider,{value:{state:r,apiClient:l,login:h,logout:()=>{o({accessToken:null,user:null}),window.localStorage.removeItem(a)}},children:e})};function h(){let t=(0,s.useContext)(c);if(!t)throw Error("useAuth must be used within AuthProvider");return t}},2014:function(t,e,r){"use strict";var n,s;t.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(6946)},6946:function(t){!function(){var e={229:function(t){var e,r,n,s=t.exports={};function o(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var c=[],u=!1,l=-1;function h(){u&&n&&(u=!1,n.length?c=n.concat(c):l=-1,c.length&&f())}function f(){if(!u){var t=a(h);u=!0;for(var e=c.length;e;){for(n=c,c=[];++l<e;)n&&n[l].run();l=-1,e=c.length}n=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}s.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new d(t,e)),1!==c.length||u||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(t){return[]},s.binding=function(t){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(t){var s=r[t];if(void 0!==s)return s.exports;var o=r[t]={exports:{}},i=!0;try{e[t](o,o.exports,n),i=!1}finally{i&&delete r[t]}return o.exports}n.ab="//";var s=n(229);t.exports=s}()},5699:function(t,e){"use strict";e.A=void 0;class r{async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken?await this.getToken():null,n=await fetch("".concat(this.baseUrl).concat(t),{...e,headers:{"Content-Type":"application/json",...r?{Authorization:"Bearer ".concat(r)}:{},...e.headers||{}}});if(!n.ok){let t=await n.text();throw Error("API error ".concat(n.status,": ").concat(t))}return n.json()}me(){return this.request("/me")}createLearner(t){return this.request("/learners",{method:"POST",body:JSON.stringify(t)})}getLearner(t){return this.request("/learners/".concat(t))}generateBaseline(t){return this.request("/baseline/generate",{method:"POST",body:JSON.stringify(t)})}submitBaselineResponses(t){return this.request("/baseline/submit",{method:"POST",body:JSON.stringify(t)})}createDifficultyProposal(t){return this.request("/difficulty/proposals",{method:"POST",body:JSON.stringify(t)})}decideOnDifficultyProposal(t){return this.request("/difficulty/proposals/".concat(t.proposalId,"/decision"),{method:"POST",body:JSON.stringify({approve:t.approve,notes:t.notes})})}listDifficultyProposals(t){let e=new URLSearchParams({learnerId:t});return this.request("/difficulty/proposals?".concat(e.toString()))}generateLessonPlan(t){return this.request("/lessons/generate",{method:"POST",body:JSON.stringify(t)})}listTenants(){return this.request("/admin/tenants")}getTenantConfig(t){return this.request("/admin/tenants/".concat(t))}listDistricts(t){return this.request("/admin/tenants/".concat(t,"/districts"))}listSchools(t,e){let r=new URLSearchParams({...e?{districtId:e}:{}}).toString();return this.request("/admin/tenants/".concat(t,"/schools").concat(r?"?".concat(r):""))}listRoleAssignments(t){return this.request("/admin/tenants/".concat(t,"/roles"))}getTodaySession(t,e){let r=new URLSearchParams({learnerId:t,subject:e});return this.request("/sessions/today?".concat(r.toString()))}startSession(t){return this.request("/sessions/start",{method:"POST",body:JSON.stringify(t)})}updateActivityStatus(t){return this.request("/sessions/".concat(t.sessionId,"/activities/").concat(t.activityId),{method:"PATCH",body:JSON.stringify({status:t.status})})}getCaregiverLearnerOverview(t){return this.request("/caregiver/learners/".concat(t,"/overview"))}listNotifications(){return this.request("/caregiver/notifications")}markNotificationRead(t){return this.request("/caregiver/notifications/".concat(t,"/read"),{method:"POST"})}getLearnerAnalytics(t){return this.request("/analytics/learners/".concat(t))}getTenantAnalytics(t){return this.request("/analytics/tenants/".concat(t))}constructor(t,e){this.baseUrl=t,this.getToken=e}}e.A=r}},function(t){t.O(0,[321,985,744],function(){return t(t.s=2715)}),_N_E=t.O()}]);